<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.16"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ColorShapeLinks AI: Console guide</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ColorShapeLinks AI
   &#160;<span id="projectnumber">v1.0.0-beta</span>
   </div>
   <div id="projectbrief">An AI competition for the IEEE Conference on Games</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.16 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('console-guide.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Console guide </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#autotoc_md6">Running the app</a><ul><li class="level2"><a href="#autotoc_md7">App options</a></li>
<li class="level2"><a href="#autotoc_md8">The match verb</a></li>
<li class="level2"><a href="#autotoc_md9">The session verb</a></li>
</ul>
</li>
<li class="level1"><a href="#listeners">Event listeners</a><ul><li class="level2"><a href="#autotoc_md10">Listener architecture</a></li>
<li class="level2"><a href="#autotoc_md11">The default listener</a></li>
<li class="level2"><a href="#autotoc_md12">Custom listeners</a></li>
</ul>
</li>
</ul>
</div>
<div class="textblock"><p>A guide on how to run an AI thinker using the console app</p>
<dl class="section remark"><dt>Remarks</dt><dd>All instructions in these guides are cross-platform and work in Linux, Windows, and macOS, requiring only that <a href="https://dotnet.microsoft.com/download">.NET Core</a> and/or <a href="https://unity.com/">Unity</a> are installed. On Windows, replace slashes <code>/</code> with backslashes <code>\</code> when referencing local paths.</dd></dl>
<h1><a class="anchor" id="autotoc_md6"></a>
Running the app</h1>
<p>In order to run the console app, <code>cd</code> into its folder (i.e., <code>ConsoleApp/ColorShapeLinks/TextBased/App</code>) and run the following command:</p>
<div class="fragment"><div class="line">$ dotnet run</div>
</div><!-- fragment --><p>Since no options were specified, the app will exit with an error message, although showing the main options. By default the app is built and executed in <em>debug</em> mode. To build and run it in <em>release</em> mode, use the following command instead:</p>
<div class="fragment"><div class="line">$ dotnet run -c Release</div>
</div><!-- fragment --><p>Command-line arguments are passed to app after two dashes, <code>--</code>, since these separate options to the <code>dotnet</code> command from the options to the app being executed. For example, the <code>info</code> option shows important environment info for running <a class="el" href="namespace_color_shape_links.html" title="The ColorShapeLinks game, an unbounded version of the Simplexity board game.">ColorShapeLinks</a> matches, for example known assemblies (units of compiled C# code) and AI thinkers. Running the console app with this options can be accomplished as follows:</p>
<div class="fragment"><div class="line">$ dotnet run -c Release -- info</div>
</div><!-- fragment --><p>Alternatively, the app can be built and executed separately:</p>
<div class="fragment"><div class="line">$ dotnet build -c Release</div>
<div class="line">$ ./bin/Release/netcoreapp3.1/ColorShapeLinks.TextBased.App</div>
</div><!-- fragment --><p>In this case, command-line options are passed directly:</p>
<div class="fragment"><div class="line">$ ./bin/Release/netcoreapp3.1/ColorShapeLinks.TextBased.App info</div>
</div><!-- fragment --><p>For the remainder of this document, we will use the first approach, i.e., the <code>dotnet run</code> command in default <em>debug</em> mode.</p>
<h2><a class="anchor" id="autotoc_md7"></a>
App options</h2>
<p>The console applications has the following main options (or verbs):</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Option/Verb  </th><th class="markdownTableHeadNone">Description   </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>session</code>  </td><td class="markdownTableBodyNone">Run a complete session (tournament) between AIs   </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>match</code>  </td><td class="markdownTableBodyNone">Run a single match between two thinkers   </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>info</code>  </td><td class="markdownTableBodyNone">Show known assemblies, thinkers and listeners, and exit   </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>help</code>  </td><td class="markdownTableBodyNone">Display more information on a specific command   </td></tr>
</table>
<p>There are two sub-options available for <b>all</b> verbs:</p>
<ul>
<li><code>-a</code>, <code>--assemblies</code>: Load .NET Standard 2.0 assemblies containing thinkers and/or listeners (space separated).</li>
<li><code>-d</code>, <code>--debug</code>: Enable debug mode, which shows exception stack traces in case an error occurs.</li>
</ul>
<p>The former option is essential for loading custom AI thinkers. To check if the AI thinkers (or custom <a class="el" href="console-guide.html#listeners">listeners</a>) are in fact loaded, the option can be used together with the <code>info</code> verb, e.g.:</p>
<div class="fragment"><div class="line">$ dotnet run -- info --assemblies /full/path/to/assembly.dll</div>
</div><!-- fragment --><p>The <code>match</code> and <code>session</code> verbs run one or more matches, respectively, and share the following sub-options:</p>
<ul>
<li><code>-r</code>, <code>--rows</code>: Number of rows in game board (default is 6).</li>
<li><code>-c</code>, <code>--cols</code>: Number of columns in game board (default is 7).</li>
<li><code>-w</code>, <code>--win-sequence</code>: How many pieces in sequence to win (default is 4).</li>
<li><code>-o</code>, <code>--round-pieces</code>: Number of initial round pieces per player (default is 10).</li>
<li><code>-s</code>, <code>--square-pieces</code>: Number of initial square pieces per player (default is 11).</li>
<li><code>-t</code>, <code>--time-limit</code>: Time limit (in milliseconds) for making move (default is 3600000, i.e., one hour).</li>
<li><code>-m</code>, <code>--min-time</code>: Minimum apparent time (in milliseconds) between moves (default is 0).</li>
<li><code>--thinker-listeners</code>: Thinker event listeners, space separated (default is <a class="el" href="class_color_shape_links_1_1_text_based_1_1_app_1_1_simple_rendering_listener.html" title="Simple event listener which renders thinker, match and session information on the console.">ColorShapeLinks.TextBased.App.SimpleRenderingListener</a>).</li>
<li><code>--match-listeners</code>: Match event listeners, space separated (default is <a class="el" href="class_color_shape_links_1_1_text_based_1_1_app_1_1_simple_rendering_listener.html" title="Simple event listener which renders thinker, match and session information on the console.">ColorShapeLinks.TextBased.App.SimpleRenderingListener</a>).</li>
</ul>
<p>These options define the board configuration for matches, the maximum and minimum apparent play times, as well as alternative thinker and match <a class="el" href="console-guide.html#listeners">listeners</a>.</p>
<h2><a class="anchor" id="autotoc_md8"></a>
The match verb</h2>
<p>The <code>match</code> verb runs a single match of <a class="el" href="namespace_color_shape_links.html" title="The ColorShapeLinks game, an unbounded version of the Simplexity board game.">ColorShapeLinks</a>. The following command list all <code>match</code> verb options:</p>
<div class="fragment"><div class="line">$ dotnet run -- help match</div>
</div><!-- fragment --><p>Of these, the following are <code>match</code> specific:</p>
<ul>
<li><code>-W</code>, <code>--white</code>: Fully qualified name of player 1 thinker class (default is <a class="el" href="class_color_shape_links_1_1_text_based_1_1_app_1_1_human_thinker.html" title="A human thinker for testing the console app.">ColorShapeLinks.TextBased.App.HumanThinker</a>).</li>
<li><code>-R</code>, <code>--red</code>: Fully qualified name of player 2 thinker class (default is <a class="el" href="class_color_shape_links_1_1_text_based_1_1_app_1_1_human_thinker.html" title="A human thinker for testing the console app.">ColorShapeLinks.TextBased.App.HumanThinker</a>).</li>
<li><code>--white-params</code>: Parameters for setting up player 1 thinker instance (no parameters are passed by default).</li>
<li><code>--red-params</code>: Parameters for setting up player 2 thinker instance (no parameters are passed by default).</li>
</ul>
<p>As such, invoking a match without any parameters will result in a match between two human players, which selected by default, i.e.:</p>
<div class="fragment"><div class="line">$ dotnet run -- match</div>
</div><!-- fragment --><p>The following command runs a match between a human player, playing as white, and a random move AI player:</p>
<div class="fragment"><div class="line">$ dotnet run -- match -R ColorShapeLinks.Common.AI.Examples.RandomAIThinker</div>
</div><!-- fragment --><p>If a third-party AI thinker named <code>MyAI.MyThinker</code> (in file <code>MyThinker.cs</code>) is placed in the <code>ConsoleApp/ColorShapeLinks/TextBased/App</code> folder, the following command runs a match between <code>MyThinker</code>, playing as white, and a random move player, playing as red, with a time limit of one second:</p>
<div class="fragment"><div class="line">dotnet run -- match -W MyAI.MyThinker -R ColorShapeLinks.Common.AI.Examples.RandomAIThinker -t 1000</div>
</div><!-- fragment --><p>If the AIs are playing too fast for human observation, a minimum apparent play time can be set, for example two seconds:</p>
<div class="fragment"><div class="line">dotnet run -- match -W MyAI.MyThinker -R ColorShapeLinks.Common.AI.Examples.RandomAIThinker -t 1000 -m 2000</div>
</div><!-- fragment --><p>In case the third-party AI thinker is developed outside the <a class="el" href="namespace_color_shape_links.html" title="The ColorShapeLinks game, an unbounded version of the Simplexity board game.">ColorShapeLinks</a> framework, which is the preferred way to do development anyway, its assembly can be specified with the <code>--assemblies</code> option:</p>
<div class="fragment"><div class="line">dotnet run -- match -W MyAI.MyThinker -R ColorShapeLinks.Common.AI.Examples.RandomAIThinker -t 1000 -m 2000 --assemblies /full/path/to/my/thinker/assembly.dll</div>
</div><!-- fragment --><p>If an AI thinker requires additional configuration parameters, these can be specified with the <code>--white-params</code>/<code>--red-params</code> options. For example, perhaps the <code>MyThinker</code> AI could accept a search depth parameter. Such a parameter could be passed as follows (note the thinkers themselves are responsible for parsing the string containing these parameters):</p>
<div class="fragment"><div class="line">dotnet run -- match -W MyAI.MyThinker -R ColorShapeLinks.Common.AI.Examples.RandomAIThinker --white-params &quot;depth=4&quot;</div>
</div><!-- fragment --><p>Different board configurations can also be specified. The following command starts a match between two human players with a 10x10 board, a winning sequence of 7 pieces, with each player starting with 24 round pieces and 25 square pieces:</p>
<div class="fragment"><div class="line">dotnet run -- match -r 10 -c 10 -w 7 -o 24 -s 25</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md9"></a>
The session verb</h2>
<p>The <code>session</code> verb runs a complete session/tournament between the AI thinkers specified in a configuration file. The following command list all <code>session</code> verb options:</p>
<div class="fragment"><div class="line">$ dotnet run -- help session</div>
</div><!-- fragment --><p>Of these, the following are <code>session</code> specific:</p>
<ul>
<li><code>--points-per-win</code>: Points per win (default is 3).</li>
<li><code>--points-per-loss</code>: Points per loss (default is 0).</li>
<li><code>--points-per-draw</code>: Points per draw (default is 1).</li>
<li><code>-g</code>, <code>--config</code>: Mandatory option which specifies the session configuration file.</li>
<li><code>--session-listeners</code>: Session event listeners, space separated (default is <a class="el" href="class_color_shape_links_1_1_text_based_1_1_app_1_1_simple_rendering_listener.html" title="Simple event listener which renders thinker, match and session information on the console.">ColorShapeLinks.TextBased.App.SimpleRenderingListener</a>).</li>
</ul>
<p>The most important of these options is <code>-g</code>, or <code>--config</code>, which accepts a session configuration file. Each line in this file should specify the participating thinker fully qualified name, followed by its specific parameters, if any, as shown in the following example:</p>
<div class="fragment"><div class="line"># Lines starting with # are ignored</div>
<div class="line"># Blank lines are also ignored</div>
<div class="line">ColorShapeLinks.Common.AI.Examples.RandomAIThinker</div>
<div class="line">MyAI.MyThinker depth=5</div>
<div class="line">Awesome.AwesomeAIThinker depth=7, turbo=boost, win=always</div>
</div><!-- fragment --><p>If this file is named "test-competition.txt", a complete session/tournament between the specified AI thinkers can be started as follows:</p>
<div class="fragment"><div class="line">$ dotnet run -- session -g test-competition.txt</div>
</div><!-- fragment --><p>If any of the AI thinkers are in external assemblies, these also need to be specified, for example:</p>
<div class="fragment"><div class="line">$ dotnet run -- session -g test-competition.txt -a /full/path/to/my/thinker/assembly.dll /full/path/to/awesome/assembly.dll</div>
</div><!-- fragment --><h1><a class="anchor" id="listeners"></a>
Event listeners</h1>
<h2><a class="anchor" id="autotoc_md10"></a>
Listener architecture</h2>
<p>Listeners are responsible for handling:</p>
<ul>
<li><a class="el" href="interface_color_shape_links_1_1_common_1_1_a_i_1_1_i_thinker.html">Thinker events</a></li>
<li><a class="el" href="interface_color_shape_links_1_1_text_based_1_1_lib_1_1_i_match_subject.html">Match events</a></li>
<li><a class="el" href="interface_color_shape_links_1_1_text_based_1_1_lib_1_1_i_session_subject.html">Session events</a></li>
</ul>
<p>Such listeners are used, for example, for rendering information on the console in response to these events. However, listeners are not limited to console rendering, and can be used to process the generated information any way the developer sees fit.</p>
<p>Listeners can be specified at runtime using the following options, which accept the listener's fully qualified name:</p>
<ul>
<li><code>--thinker-listeners</code>, available to <code>match</code> and <code>session</code> verbs.</li>
<li><code>--match-listeners</code>, available to <code>match</code> and <code>session</code> verbs.</li>
<li><code>--session-listeners</code>, only available to the <code>session</code> verb.</li>
</ul>
<p>More than one listener can be specified and default listeners can be disabled. For example, the following command specifies two thinker listeners, while disabling all match listeners:</p>
<div class="fragment"><div class="line">$ dotnet run -- match --thinker-listeners My.ThinkListnr Other.ThinkListnr --match-listeners &quot;&quot;</div>
</div><!-- fragment --><p>Known listeners can be listed with the <code>info</code> verb:</p>
<div class="fragment"><div class="line">$ dotnet run -- info</div>
</div><!-- fragment --><p>If listeners are defined in an external assembly, the assembly also needs to be specified, e.g.:</p>
<div class="fragment"><div class="line">$ dotnet run -- info -a /full/path/to/listener/assembly.dll</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md11"></a>
The default listener</h2>
<p>The <a class="el" href="class_color_shape_links_1_1_text_based_1_1_app_1_1_simple_rendering_listener.html">SimpleRenderingListener</a> implements all three listener interfaces, namely <a class="el" href="interface_color_shape_links_1_1_text_based_1_1_lib_1_1_i_thinker_listener.html">IThinkerListener</a>, <a class="el" href="interface_color_shape_links_1_1_text_based_1_1_lib_1_1_i_match_listener.html">IMatchListener</a> and <a class="el" href="interface_color_shape_links_1_1_text_based_1_1_lib_1_1_i_session_listener.html">ISessionListener</a>. As such, it is able to listen to <a class="el" href="interface_color_shape_links_1_1_common_1_1_a_i_1_1_i_thinker.html">thinker</a>, <a class="el" href="interface_color_shape_links_1_1_text_based_1_1_lib_1_1_i_match_subject.html">match</a> and <a class="el" href="interface_color_shape_links_1_1_text_based_1_1_lib_1_1_i_session_subject.html">session</a> events, and is used as the default listener in the configurations described in the following paragraphs.</p>
<p>When running simple matches (i.e., using the <code>match</code> verb), the <a class="el" href="class_color_shape_links_1_1_text_based_1_1_app_1_1_simple_rendering_listener.html">SimpleRenderingListener</a> is registered as a <a class="el" href="interface_color_shape_links_1_1_text_based_1_1_lib_1_1_i_thinker_listener.html">thinker listener</a> and a <a class="el" href="interface_color_shape_links_1_1_text_based_1_1_lib_1_1_i_match_listener.html">match listener</a>. There are no <a class="el" href="interface_color_shape_links_1_1_text_based_1_1_lib_1_1_i_session_subject.html">session events</a> when running simple matches.</p>
<p>Similarly, <a class="el" href="class_color_shape_links_1_1_text_based_1_1_app_1_1_simple_rendering_listener.html">SimpleRenderingListener</a> is registered as a <a class="el" href="interface_color_shape_links_1_1_text_based_1_1_lib_1_1_i_session_listener.html">session listener</a> when running complete sessions/tournaments with the <code>session</code> verb. By default, no <a class="el" href="interface_color_shape_links_1_1_text_based_1_1_lib_1_1_i_thinker_listener.html">thinker</a> and <a class="el" href="interface_color_shape_links_1_1_text_based_1_1_lib_1_1_i_match_listener.html">match</a> listeners are registered during complete sessions.</p>
<p>The <a class="el" href="class_color_shape_links_1_1_text_based_1_1_app_1_1_simple_rendering_listener.html">SimpleRenderingListener</a> works according to its name, outputting <a class="el" href="interface_color_shape_links_1_1_common_1_1_a_i_1_1_i_thinker.html">thinker</a>, <a class="el" href="interface_color_shape_links_1_1_text_based_1_1_lib_1_1_i_match_subject.html">match</a> and <a class="el" href="interface_color_shape_links_1_1_text_based_1_1_lib_1_1_i_session_subject.html">session</a> events to the console in the simplest possible fashion.</p>
<h2><a class="anchor" id="autotoc_md12"></a>
Custom listeners</h2>
<p>A custom listener can listen to several events of one or more types. Depending on the types of event to listen, the custom listener must implement one or more of the following interfaces:</p>
<ul>
<li><a class="el" href="interface_color_shape_links_1_1_text_based_1_1_lib_1_1_i_thinker_listener.html">IThinkerListener</a> for listening to <a class="el" href="interface_color_shape_links_1_1_common_1_1_a_i_1_1_i_thinker.html">thinker events</a>.</li>
<li><a class="el" href="interface_color_shape_links_1_1_text_based_1_1_lib_1_1_i_match_listener.html">IMatchListener</a> for listening to <a class="el" href="interface_color_shape_links_1_1_text_based_1_1_lib_1_1_i_match_subject.html">match events</a>.</li>
<li><a class="el" href="interface_color_shape_links_1_1_text_based_1_1_lib_1_1_i_session_listener.html">ISessionListener</a> for listening to <a class="el" href="interface_color_shape_links_1_1_text_based_1_1_lib_1_1_i_session_subject.html">session events</a>.</li>
</ul>
<p>As an example, we'll show how to implement a listener to output information about all the moves performed in a match to a CSV file which can be opened in a spreadsheet.</p>
<p>First, create a project folder, <code>cd</code> into the folder and create a new class library project, removing the temporary C# class that is created:</p>
<div class="fragment"><div class="line">$ mkdir CSVListeners</div>
<div class="line">$ cd CSVListeners</div>
<div class="line">$ dotnet new classlib</div>
<div class="line">$ rm Class1.cs</div>
</div><!-- fragment --><p>The new project needs to reference the <a class="el" href="namespace_color_shape_links_1_1_common.html" title="The common code between all ColorShapeLinks implementations.">ColorShapeLinks.Common</a> and <a class="el" href="namespace_color_shape_links_1_1_text_based_1_1_lib.html" title="Library &quot;engine&quot; code for console or third-party implementations of ColorShapeLinks.">ColorShapeLinks.TextBased.Lib</a> projects:</p>
<div class="fragment"><div class="line">$ dotnet add reference /path/to/color-shape-links-ai-competition/ConsoleApp/ColorShapeLinks/Common</div>
<div class="line">$ dotnet add reference /path/to/color-shape-links-ai-competition/ConsoleApp/ColorShapeLinks/TextBased/Lib</div>
</div><!-- fragment --><p>Open your favorite IDE and create a new class named for example <code>MatchListener</code>, which should appear as follows:</p>
<div class="fragment"><div class="line"><span class="keyword">using</span> System;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">namespace </span>CSVListeners</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">public</span> <span class="keyword">class </span>MatchListener</div>
<div class="line">    {</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --><p>We don't need the <code>System</code> namespace, but we do need the <a class="el" href="namespace_color_shape_links_1_1_text_based_1_1_lib.html" title="Library &quot;engine&quot; code for console or third-party implementations of ColorShapeLinks.">ColorShapeLinks.TextBased.Lib</a> namespace. Furthermore, our <code>MatchListener</code> must implement <code>IMatchListener</code>:</p>
<div class="fragment"><div class="line"><span class="keyword">using</span> <a class="code" href="namespace_color_shape_links.html">ColorShapeLinks</a>.<a class="code" href="namespace_color_shape_links_1_1_text_based.html">TextBased</a>.<a class="code" href="namespace_color_shape_links_1_1_text_based_1_1_lib.html">Lib</a>;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">namespace </span>CSVListeners</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">public</span> <span class="keyword">class </span>MatchListener : IMatchListener</div>
<div class="line">    {</div>
<div class="line">        <span class="keyword">public</span> <span class="keywordtype">void</span> ListenTo(IMatchSubject subject)</div>
<div class="line">        {</div>
<div class="line"> </div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --><p>Since our goal is to write information about all moves performed in a match to a CSV file, we need to:</p>
<ol type="1">
<li>Listen for the start of the match, determine the file name and open the file for writing.</li>
<li>Listen for moves performed, and write information about them to the file.</li>
<li>Listen for the end of the match and close the file.</li>
</ol>
<p>Thus, we need to create methods for each of these actions, and register them with the appropriate events, namely <a class="el" href="interface_color_shape_links_1_1_text_based_1_1_lib_1_1_i_match_subject.html#a58d974257264b3bf4160f99cf6b73fe5">MatchStart</a>, <a class="el" href="interface_color_shape_links_1_1_text_based_1_1_lib_1_1_i_match_subject.html#a58d974257264b3bf4160f99cf6b73fe5">MovePerformed</a> and <a class="el" href="interface_color_shape_links_1_1_text_based_1_1_lib_1_1_i_match_subject.html#a58d974257264b3bf4160f99cf6b73fe5">MatchOver</a>. The skeleton of such code can be as follows:</p>
<div class="fragment"><div class="line"><span class="keyword">using</span> <a class="code" href="namespace_color_shape_links.html">ColorShapeLinks</a>.<a class="code" href="namespace_color_shape_links_1_1_common.html">Common</a>;</div>
<div class="line"><span class="keyword">using</span> <a class="code" href="namespace_color_shape_links.html">ColorShapeLinks</a>.<a class="code" href="namespace_color_shape_links_1_1_common.html">Common</a>.<a class="code" href="namespace_color_shape_links_1_1_common_1_1_a_i.html">AI</a>;</div>
<div class="line"><span class="keyword">using</span> <a class="code" href="namespace_color_shape_links.html">ColorShapeLinks</a>.<a class="code" href="namespace_color_shape_links_1_1_common.html">Common</a>.<a class="code" href="namespace_color_shape_links_1_1_common_1_1_session.html">Session</a>;</div>
<div class="line"><span class="keyword">using</span> <a class="code" href="namespace_color_shape_links.html">ColorShapeLinks</a>.<a class="code" href="namespace_color_shape_links_1_1_text_based.html">TextBased</a>.<a class="code" href="namespace_color_shape_links_1_1_text_based_1_1_lib.html">Lib</a>;</div>
<div class="line"><span class="keyword">using</span> System.Collections.Generic;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">namespace </span>CSVListeners</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">public</span> <span class="keyword">class </span>MatchListener : IMatchListener</div>
<div class="line">    {</div>
<div class="line">        <span class="keyword">public</span> <span class="keywordtype">void</span> ListenTo(IMatchSubject subject)</div>
<div class="line">        {</div>
<div class="line">            subject.MatchStart += OpenFile;</div>
<div class="line">            subject.MovePerformed += WriteToFile;</div>
<div class="line">            subject.MatchOver += CloseFile;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> OpenFile(IMatchConfig config, IList&lt;string&gt; thinkers)</div>
<div class="line">        {</div>
<div class="line"> </div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> WriteToFile(PColor color, <span class="keywordtype">string</span> thinker, FutureMove fm, <span class="keywordtype">int</span> moveDuration)</div>
<div class="line">        {</div>
<div class="line"> </div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> CloseFile(Winner winner, ICollection&lt;Pos&gt; solution, IList&lt;string&gt; thinkers)</div>
<div class="line">        {</div>
<div class="line"> </div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --><p>We need to add some code to these methods:</p>
<div class="fragment"><div class="line"><span class="keyword">using</span> <a class="code" href="namespace_color_shape_links.html">ColorShapeLinks</a>.<a class="code" href="namespace_color_shape_links_1_1_common.html">Common</a>;</div>
<div class="line"><span class="keyword">using</span> <a class="code" href="namespace_color_shape_links.html">ColorShapeLinks</a>.<a class="code" href="namespace_color_shape_links_1_1_common.html">Common</a>.<a class="code" href="namespace_color_shape_links_1_1_common_1_1_a_i.html">AI</a>;</div>
<div class="line"><span class="keyword">using</span> <a class="code" href="namespace_color_shape_links.html">ColorShapeLinks</a>.<a class="code" href="namespace_color_shape_links_1_1_common.html">Common</a>.<a class="code" href="namespace_color_shape_links_1_1_common_1_1_session.html">Session</a>;</div>
<div class="line"><span class="keyword">using</span> <a class="code" href="namespace_color_shape_links.html">ColorShapeLinks</a>.<a class="code" href="namespace_color_shape_links_1_1_text_based.html">TextBased</a>.<a class="code" href="namespace_color_shape_links_1_1_text_based_1_1_lib.html">Lib</a>;</div>
<div class="line"><span class="keyword">using</span> System.Collections.Generic;</div>
<div class="line"><span class="keyword">using</span> System.IO;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">namespace </span>CSVListeners</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">public</span> <span class="keyword">class </span>MatchListener : IMatchListener</div>
<div class="line">    {</div>
<div class="line">        <span class="keyword">private</span> StreamWriter file;</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">public</span> <span class="keywordtype">void</span> ListenTo(IMatchSubject subject)</div>
<div class="line">        {</div>
<div class="line">            subject.MatchStart += OpenFile;</div>
<div class="line">            subject.MovePerformed += WriteToFile;</div>
<div class="line">            subject.MatchOver += CloseFile;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> OpenFile(IMatchConfig config, IList&lt;string&gt; thinkers)</div>
<div class="line">        {</div>
<div class="line">            <span class="comment">// Use the thinker names as the basis for the filename</span></div>
<div class="line">            file = <span class="keyword">new</span> StreamWriter($<span class="stringliteral">&quot;{thinkers[0]}vs{thinkers[1]}.csv&quot;</span>);</div>
<div class="line"> </div>
<div class="line">            <span class="comment">// Write the header</span></div>
<div class="line">            file.WriteLine(<span class="stringliteral">&quot;\&quot;Thinker\&quot;,\&quot;Color\&quot;,\&quot;Shape\&quot;,\&quot;Column\&quot;,\&quot;Think time (ms)\&quot;&quot;</span>);</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> WriteToFile(PColor color, <span class="keywordtype">string</span> thinker, FutureMove fm, <span class="keywordtype">int</span> thinkTime)</div>
<div class="line">        {</div>
<div class="line">            file.WriteLine($<span class="stringliteral">&quot;\&quot;{thinker}\&quot;,\&quot;{color}\&quot;,\&quot;{fm.shape}\&quot;,{fm.column},{thinkTime}&quot;</span>);</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> CloseFile(Winner winner, ICollection&lt;Pos&gt; solution, IList&lt;string&gt; thinkers)</div>
<div class="line">        {</div>
<div class="line">            file.Close();</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --><p>Now build the project:</p>
<div class="fragment"><div class="line">$ dotnet build</div>
</div><!-- fragment --><p>Open another terminal and <code>cd</code> into the <code>ConsoleApp/ColorShapeLinks/TextBased/App</code> folder. Run the console app specifying our custom match listener and disabling the default thinker listener, running a match between a sequential AI player and a basic (but not completely dumb) AI. Note we need to specify the assembly containing our custom listener:</p>
<div class="fragment"><div class="line">$ dotnet run -- match -W ColorShapeLinks.Common.AI.Examples.SequentialAIThinker -R ColorShapeLinks.Test.BasicNegamax --thinker-listeners &quot;&quot; --match-listeners CSVListeners.MatchListener -a /path/to/CSVListener/bin/Debug/netstandard2.0/CSVListener.dll</div>
</div><!-- fragment --><p>Nothing appears on screen, since the only enabled listener is our custom one, which only outputs content to a file. If everything goes well, a file named <code>SequentialvsBasicNegamax.csv</code> will appear in the app folder. Opening the file with LibreOffice Calc or Microsoft Excel yields something similar to:</p>
<p><img src="https://user-images.githubusercontent.com/3018963/75799140-8a398580-5d6f-11ea-97d9-65bba3a5bd28.png" alt="image" class="inline"/></p>
<p>The process of writing other types of listener is similar, requiring only a knowledge of what events are produced by <a class="el" href="interface_color_shape_links_1_1_common_1_1_a_i_1_1_i_thinker.html">thinkers</a>, <a class="el" href="interface_color_shape_links_1_1_text_based_1_1_lib_1_1_i_match_subject.html">matches</a> and <a class="el" href="interface_color_shape_links_1_1_text_based_1_1_lib_1_1_i_session_subject.html">sessions</a>. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<div class="ttc" id="anamespace_color_shape_links_1_1_common_1_1_a_i_html"><div class="ttname"><a href="namespace_color_shape_links_1_1_common_1_1_a_i.html">ColorShapeLinks.Common.AI</a></div><div class="ttdoc">Common AI-related types between all ColorShapeLinks implementations.</div><div class="ttdef"><b>Definition:</b> AbstractThinker.cs:12</div></div>
<div class="ttc" id="anamespace_color_shape_links_html"><div class="ttname"><a href="namespace_color_shape_links.html">ColorShapeLinks</a></div><div class="ttdoc">The ColorShapeLinks game, an unbounded version of the Simplexity board game.</div><div class="ttdef"><b>Definition:</b> AIPlayer.cs:12</div></div>
<div class="ttc" id="anamespace_color_shape_links_1_1_text_based_1_1_lib_html"><div class="ttname"><a href="namespace_color_shape_links_1_1_text_based_1_1_lib.html">ColorShapeLinks.TextBased.Lib</a></div><div class="ttdoc">Library &quot;engine&quot; code for console or third-party implementations of ColorShapeLinks.</div><div class="ttdef"><b>Definition:</b> ExitStatus.cs:9</div></div>
<div class="ttc" id="anamespace_color_shape_links_1_1_text_based_html"><div class="ttname"><a href="namespace_color_shape_links_1_1_text_based.html">ColorShapeLinks.TextBased</a></div><div class="ttdoc">A console implementation of the ColorShapeLinks board game.</div><div class="ttdef"><b>Definition:</b> BaseOptions.cs:12</div></div>
<div class="ttc" id="anamespace_color_shape_links_1_1_common_html"><div class="ttname"><a href="namespace_color_shape_links_1_1_common.html">ColorShapeLinks.Common</a></div><div class="ttdoc">The common code between all ColorShapeLinks implementations.</div><div class="ttdef"><b>Definition:</b> AbstractThinker.cs:12</div></div>
<div class="ttc" id="anamespace_color_shape_links_1_1_common_1_1_session_html"><div class="ttname"><a href="namespace_color_shape_links_1_1_common_1_1_session.html">ColorShapeLinks.Common.Session</a></div><div class="ttdoc">Common match and session setup code for ColorShapeLinks games.</div><div class="ttdef"><b>Definition:</b> IMatchConfig.cs:9</div></div>
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Mon Mar 16 2020 23:51:20 for ColorShapeLinks AI by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.16 </li>
  </ul>
</div>
</body>
</html>
